<!-- Goods 팝업 => iframe -->

<h2>전시페이지 팝업 6 : Goods</h2>

<section class="fb__sect">
    <div class="wrap-location">
        <h1 class="title">컨텐츠 등록</h1>
    </div>

    <!-- Goods 등록 화면 -->
    <div class="fb__sect">
        <form id="" class="inputForm" name="inputForm" method="post">
            <!-- 팝업 폼 섹션 1 -->
            <section class="inputForm__section">
                <header class="inputForm__section__header">
                    <h3 class="inputForm__section__title">&gt; 컨텐츠 기본 정보</h3>
                </header>
                <table class="datatable v-type">
                    <colgroup>
                        <col style="width:15%">
                        <col style="width:35%">
                        <col style="width:15%">
                        <col style="width:35%">
                    </colgroup>
                    <tbody>
                        <!-- 전시 기간 -->
                        <tr>
                            <th>
                                <label class="req-star-th">전시 기간</label>
                            </th>
                            <td colspan="3">
                                <div class="need-resize">
                                    <div class="datepicker-wrapper startdate-wrapper">
                                        <input type="text" class="comm-input">
                                        <input type="text" name="startHour" class="fb__timepicker" />
                                        <input type="text" name="startMin" class="fb__timepicker" />
                                    </div>


                                    <!-- 종료 Datepicker -->
                                    <div class="datepicker-wrapper">
                                        <input type="text" class="comm-input">
                                        <input type="text" name="endHour" class="fb__timepicker" />
                                        <input type="text" name="endMin" class="fb__timepicker" />
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <!-- 타이틀 명 -->
                            <th>
                                <label class="req-star-th">타이틀 명</label>
                            </th>
                            <td>
                                <div class="limit-control">
                                    <input type="text" class="comm-input lengthCheck" value="" maxlength="20"
                                        data-reg-exp="includeSymbol" style="width:80%">
                                    <p class="showLimit">
                                        <span class="currentInput-length">0</span>
                                        /
                                        <span class="maxInput-length">20</span>
                                    </p>
                                </div>
                            </td>
                            <!-- 전시범위 -->
                            <th>
                                <label class="req-star-th">전시범위</label>
                            </th>
                            <td>
                                <div class="complex-condition">
                                    <input type="text" id="전시범위" class="comm-input" value="전체">
                                </div>
                            </td>
                        </tr>
                        <!-- 구좌 상세정보 -->
                        <tr>
                            <th>
                                <label>구좌 상세정보</label>
                            </th>
                            <td colspan="3">
                                <div class="complex-condition textarea-wrapper">
                                    <textarea class="comm-textarea"></textarea>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- 팝업 폼 섹션 2 -->
            <section class="inputForm__section">
                <header class="inputForm__section__header">
                    <h3 class="inputForm__section__title">&gt; 상품조회</h3>
                </header>
                <div>
                    <nav class="fb__custom__radio">
                        <label for="tab1">
                            <input type="radio" id="tab1" name="tab-select" value="single-section" checked="true">
                            <span>단일조건 검색</span>
                        </label>
                        <label for="tab2">
                            <input type="radio" id="tab2" name="tab-select" value="multi-section">
                            <span>복수조건 검색</span>
                        </label>
                    </nav>
                    <section class="codition-sec" id="single-section">
                        <table class="datatable v-type">
                            <colgroup>
                                <col style="width : 15%">
                                <col style="width : 85%">
                            </colgroup>
                            <tbody>
                                <tr>
                                    <th><label>코드검색</label></th>
                                    <td>
                                        <div class="complex-condition">
                                            <div class="tableCell top paddingR10" style="width: 20%;">
                                                <input type="text" class="fb__custom__select" style="width: 100%;">
                                            </div>
                                            <div class="textarea-wrapper tableCell" style="width: 80%;">
                                                <textarea class="comm-textarea"></textarea>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section class="codition-sec clearfix" id="multi-section" style="display: none;">
                        <table class="datatable v-type">
                            <colgroup>
                                <col style="width : 15%">
                                <col style="width : 35%">
                                <col style="width : 15%">
                                <col style="width : 35%">
                            </colgroup>
                            <tbody>
                                <tr>
                                    <th rowspan="2"><label>상품명</label></th>
                                    <td rowspan="2">
                                        <div class="textarea-wrapper">
                                            <textarea class="comm-textarea"></textarea>
                                        </div>
                                    </td>
                                    <th><label>공급업체 검색</label></th>
                                    <td>
                                        <div class="complex-condition">
                                            <input type="text" class="fb__custom__select" value="공급업체 전체"
                                                style="width : 100%;">
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th><label>브랜드 검색</label></th>
                                    <td>
                                        <div class="complex-condition">
                                            <input type="text" class="fb__custom__select" value="브랜드 전체"
                                                style="width : 100%;">
                                        </div>
                                    </td>
                                </tr>
                                <!-- 카테고리 검색 -->
                                <tr>
                                    <th><label>카테고리 검색</label></th>
                                    <td colspan="3">
                                        <div class="complex-condition">
                                            <input class="fb__custom__select marginR5" type="text"
                                                style="width : 130px">
                                            <input class="fb__custom__select marginR5" type="text"
                                                style="width : 130px">
                                            <input class="fb__custom__select marginR5" type="text"
                                                style="width : 130px">
                                            <input class="fb__custom__select marginR5" type="text"
                                                style="width : 130px">
                                            <input class="fb__custom__select" type="text" style="width : 130px">
                                        </div>
                                    </td>
                                </tr>
                                <!-- 기간검색 -->
                                <tr>
                                    <th>
                                        <label class="req-star-th">기간검색</label>
                                    </th>
                                    <td colspan="3">
                                        <div class="need-resize">
                                            <div class="datepicker-wrapper startdate-wrapper">
                                                <input type="text" id="t" class="comm-input">
                                                <input type="text" class="fb__timepicker" />
                                                <input type="text" class="fb__timepicker" />
                                            </div>
                                            <div class="datepicker-wrapper">
                                                <input type="text" class="comm-input">
                                                <input type="text" class="fb__timepicker" />
                                                <input type="text" class="fb__timepicker" />
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <!-- 상품 유형 -->
                                <tr class="detail-condition">
                                    <th><label>상품유형</label></th>
                                    <td colspan="3">
                                        <div class="complex-condition">
                                            <div class="checkbox-wrapper fb__custom__checkbox"></div>
                                        </div>
                                    </td>
                                </tr>
                                <!-- 판매 상태 -->
                                <tr class="detail-condition">
                                    <th><label>판매상태</label></th>
                                    <td colspan="3">
                                        <div class="complex-condition">
                                            <div class="checkbox-wrapper fb__custom__checkbox"></div>
                                        </div>
                                    </td>
                                </tr>
                                <!-- 판매 유형 -->
                                <tr class="detail-condition">
                                    <th><label>판매유형</label></th>
                                    <td>
                                        <div class="complex-condition">
                                            <div class="checkbox-wrapper fb__custom__checkbox"></div>
                                        </div>
                                    </td>
                                    <th><label>전시여부</label></th>
                                    <td>
                                        <div class="complex-condition">
                                            <div class="checkbox-wrapper fb__custom__radio"></div>
                                        </div>
                                    </td>
                                </tr>
                                <!-- 구매허용범위 & 판매허용범위-->
                                <tr class="detail-condition">
                                    <th><label>구매허용범위</label></th>
                                    <td>
                                        <div class="complex-condition">
                                            <div class="checkbox-wrapper fb__custom__radio"></div>
                                        </div>
                                    </td>
                                    <th><label>판매허용범위</label></th>
                                    <td>
                                        <div class="complex-condition">
                                            <div class="checkbox-wrapper fb__custom__radio"></div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="floatRight">
                            <button id="fnToggleSearchOption" class="btn-blue btn-m btn-toggle" type="button">상세검색
                                <span class="toggle-icon">▼</span>
                            </button>
                        </div>
                    </section>
                </div>
            </section>

            <span class="btn-area">
                <button type="submit" id="" class="btn-l btn-point">
                    조회
                </button>
                <button type="button" id="" class="btn-l btn-point">
                    초기화
                </button>
            </span>
        </form>
    </div>

    <!-- Goods 수정 화면 -->
    <div class="fb__sect">
        <form id="" class="inputForm" name="inputForm" method="post">
            <!-- 팝업 폼 섹션 1 -->
            <section class="inputForm__section">
                <header class="inputForm__section__header">
                    <h3 class="inputForm__section__title">&gt; 컨텐츠 기본 정보</h3>
                </header>
                <table class="datatable v-type">
                    <colgroup>
                        <col style="width:15%">
                        <col style="width:35%">
                        <col style="width:15%">
                        <col style="width:35%">
                    </colgroup>
                    <tbody>
                        <!-- 전시 기간 -->
                        <tr>
                            <th>
                                <label class="req-star-th">전시 기간</label>
                            </th>
                            <td colspan="3">
                                <div class="need-resize">
                                    <div class="datepicker-wrapper startdate-wrapper">
                                        <input type="text" class="comm-input">
                                        <input type="text" name="startHour" class="fb__timepicker" />
                                        <input type="text" name="startMin" class="fb__timepicker" />
                                    </div>


                                    <!-- 종료 Datepicker -->
                                    <div class="datepicker-wrapper">
                                        <input type="text" class="comm-input">
                                        <input type="text" name="endHour" class="fb__timepicker" />
                                        <input type="text" name="endMin" class="fb__timepicker" />
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <!-- 타이틀 명 -->
                            <th>
                                <label class="req-star-th">타이틀 명</label>
                            </th>
                            <td>
                                <div class="limit-control">
                                    <input type="text" class="comm-input lengthCheck" value="" maxlength="20"
                                        data-reg-exp="includeSymbol" style="width:80%">
                                    <p class="showLimit">
                                        <span class="currentInput-length">0</span>
                                        /
                                        <span class="maxInput-length">20</span>
                                    </p>
                                </div>
                            </td>
                            <!-- 전시범위 -->
                            <th>
                                <label class="req-star-th">전시범위</label>
                            </th>
                            <td>
                                <div class="complex-condition">
                                    <input type="text" id="전시범위" class="comm-input" value="전체">
                                </div>
                            </td>
                        </tr>
                        <!-- 순번 => 수정 페이지의 경우만 사용 -->
                        <tr>
                            <th>
                                <label class="req-star-th">순번</label>
                            </th>
                            <td>
                                <div class="complex-condition">
                                    <input type="text" class="comm-input" style="width : 160px">
                                </div>
                            </td>
                        </tr>
                        <!-- 구좌 상세정보 -->
                        <tr>
                            <th>
                                <label>구좌 상세정보</label>
                            </th>
                            <td colspan="3">
                                <div class="complex-condition textarea-wrapper">
                                    <textarea class="comm-textarea"></textarea>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section class="inpurForm__section">
                <table class="datatable v-type">
                    <colgroup>
                        <col style="width : 10%">
                        <col style="width : 15%">
                        <col style="width : 25%">
                        <col style="width : 25%">
                        <col style="width : 15%">
                        <col style="width : 10%">
                    </colgroup>
                    <thead>
                        <tr>
                            <th><label>상품코드</label></th>
                            <th><label>상품명</label></th>
                            <th><label>노출텍스트1</label></th>
                            <th><label>노출텍스트2</label></th>
                            <th><label>공급업체</label></th>
                            <th><label>전시여부</label></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <!-- 상품 코드 -->
                            <td>
                                <div class="complex-condition">
                                    <input type="text" class="comm-input" style="width: 100%;">
                                </div>
                            </td>
                            <!-- 상품명 -->
                            <td>
                                <div class="complex-condition">
                                    <input type="text" class="comm-input" style="width: 100%;">
                                </div>
                            </td>
                            <!-- 노출 텍스트1 -->
                            <td>
                                <div class="exposeText-wrapper">
                                    <div class="exposeText-wrapper__sec">
                                        <input type="text" class="comm-input colorCode">
                                    </div>
                                    <div class="limit-control exposeText-wrapper__sec">
                                        <input type="text" class="comm-input lengthCheck" maxlength="15">
                                        <p class="showLimit">
                                            <span class="currentInput-length">0</span>
                                            /
                                            <span class="maxInput-length">15</span>
                                        </p>
                                    </div>
                                </div>
                            </td>
                            <!-- 노출 텍스트2 -->
                            <td>
                                <div class="exposeText-wrapper">
                                    <div class="exposeText-wrapper__sec">
                                        <input type="text" class="comm-input colorCode">
                                    </div>
                                    <div class="limit-control exposeText-wrapper__sec">
                                        <input type="text" class="comm-input lengthCheck" maxlength="15">
                                        <p class="showLimit">
                                            <span class="currentInput-length">0</span>
                                            /
                                            <span class="maxInput-length">15</span>
                                        </p>
                                    </div>
                                </div>
                            </td>
                            <!-- 공급업체 -->
                            <td>
                                <div class="complex-condition">
                                    <input type="text" class="comm-input" style="width: 100%;" value="풀무원식품">
                                </div>
                            </td>
                            <!-- 전시여부 -->
                            <td>
                                <div class="complex-condition">
                                    <input type="text" class="comm-input" style="width: 100%;" value="전체">
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <span class="btn-area">
                <button type="submit" id="submit-btn" class="btn-l btn-point">
                    등록
                </button>
            </span>
        </form>
        <!-- 팝업 -->
        <div id="popup" class="fb__mask goodsContent__popup">
            <div class="fb__layer__cont fb__popup__size--1">
                <p class="popup__header">동일 기간에 전시중인 상품을 제외한 상품등록이 완료되었습니다.</p>
                <div class="popup__content">
                    <strong>제외 상품 정보 : </strong>
                    <p id="excludeInfo">
                    </p>
                </div>
                <button id="popup-closeBtn" type="button" class="btn-l btn-point">확인</button>
            </div>
        </div>
    </div>
</section>

<script>
    $(document).ready(function () {
        // 단일/복수조건 탭 선택 이벤트
        function bindTabEvent() {
            const $tabs = $("input[name='tab-select']");

            $tabs.on("change", function (e) {
                const $target = e.target;
                const $sections = $(".codition-sec");

                $sections.hide();

                if ($target.checked) {
                    const _id = $target.value;
                    $("#" + _id).show();
                }
            })
        }

        //글자수 제한 및 글자수 표시, 특정 문자 입력 제한 함수
        function bindKeyupEvents() {
            const REG_EXP = {
                onlyNum: /[^0-9]/g,
                onlyEng: /[^a-zA-Z]/g,
                includeSymbol: /[^0-9a-zA-Z\-]/gi,
            }

            $(".lengthCheck").on("keyup", function (e) {
                const $titleLength = $(this).parent().find(".currentInput-length")[0];

                const dataReg = $(this).data("regExp");

                const MAX_LENGTH = !!this.maxLength ? this.maxLength : null;
                const regExp = dataReg ? REG_EXP[dataReg] : null;

                let _value = $(this).val();

                if (regExp && regExp.test(_value)) {
                    _value = _value.replace(regExp, "");
                }

                if (MAX_LENGTH && MAX_LENGTH < _value.length) {
                    _value = _value.slice(0, MAX_LENGTH);
                }

                $(this).val(_value);

                if ($titleLength) {
                    $titleLength.innerHTML = $(this).val().length;
                }
            })
        }

        // 복수 조건 검색 상세검색 버튼 이벤트
        function bindDetailBtnEvent() {
            const $btn = $("#fnToggleSearchOption");
            $btn.on("click", function (e) {
                const OPENED_CN = "opened";

                const isOpened = this.classList.contains(OPENED_CN);
                toggleTableRow(isOpened);
                this.classList.toggle(OPENED_CN);
            })

        }

        // 상세검색 테이블 행 토글 함수
        function toggleTableRow(isOpened) {
            const $detailRow = $(".detail-condition");
            isOpened ? $detailRow.hide() : $detailRow.show();
        }

        // 등록 버튼 이벤트
        function bindSubmitBtnEvent() {
            $("#submit-btn").on("click", function (e) {
                e.preventDefault();

                // 중복 여부 판단
                // true : 중복 존재
                var isDuplicated = true;

                if (isDuplicated) {
                    var $excludeInfo = $("#excludeInfo");
                    $excludeInfo.html("sample text");

                    showPopup(true);
                } else {
                    fnKendoMessage({
                        message: "상품 등록이 완료되었습니다.",
                    })
                }
            })
        }

        // 팝업창 show/hide
        function showPopup(toggle) {
            var $popup = $("#popup");
            toggle ? $popup.addClass("show") : $popup.removeClass("show");
        }

        // 팝업창 닫기 버튼 이벤트
        function bindPopupBtnEvent() {
            $("#popup-closeBtn").on("click", function (e) {
                showPopup(false);
            })
        }

        // Goods 팝업
        function initGoods() {
            bindTabEvent();
            bindKeyupEvents();
            bindDetailBtnEvent();
            bindSubmitBtnEvent();
            bindPopupBtnEvent();
            toggleTableRow(true);
        }

        initGoods();
    })
</script>